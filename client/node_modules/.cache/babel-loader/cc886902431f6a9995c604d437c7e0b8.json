{"ast":null,"code":"import _objectSpread from\"/Users/michalwanto/Desktop/Testing-Trial/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/michalwanto/Desktop/Testing-Trial/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(clearCartOnSignOutSuccess),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(addCartToFirestoreAsync),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(fetchCartItemsFromFirestoreAsync),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutSuccess),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(onAddCartToFirestoreStart),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(onFetchCartItemsFromFirestoreStart),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(cartSagas);import{all,put,takeLatest,call}from\"redux-saga/effects\";import UserActionTypes from\"../user/user.types\";import{getCurrentUser,firestore}from\"../../firebase/firebase.utils\";import{clearCart,fetchCartItemsFromFirestoreSuccess,fetchCartItemsFromFirestoreFailure}from\"./cart.actions\";import CartActionTypes from\"./cart.types\";export function clearCartOnSignOutSuccess(){return _regeneratorRuntime.wrap(function clearCartOnSignOutSuccess$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return put(clearCart());case 2:case\"end\":return _context.stop();}}},_marked);}export function addCartToFirestoreAsync(_ref){var items,userAuth,userRef,snapshot,mapCartItems;return _regeneratorRuntime.wrap(function addCartToFirestoreAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:items=_ref.payload;_context2.prev=1;_context2.next=4;return getCurrentUser();case 4:userAuth=_context2.sent;_context2.next=7;return firestore.doc(\"users/\".concat(userAuth.uid));case 7:userRef=_context2.sent;_context2.next=10;return userRef.get();case 10:snapshot=_context2.sent;_context2.next=13;return items.map(function(item){return item;});case 13:mapCartItems=_context2.sent;_context2.next=16;return userRef.set(_objectSpread(_objectSpread({},snapshot.data()),{},{cartItems:mapCartItems}));case 16:_context2.next=21;break;case 18:_context2.prev=18;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 21:case\"end\":return _context2.stop();}}},_marked2,null,[[1,18]]);}export function fetchCartItemsFromFirestoreAsync(){var userAuth,userRef,snapshot,cartItems;return _regeneratorRuntime.wrap(function fetchCartItemsFromFirestoreAsync$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return getCurrentUser();case 3:userAuth=_context3.sent;_context3.next=6;return firestore.doc(\"users/\".concat(userAuth.uid));case 6:userRef=_context3.sent;_context3.next=9;return userRef.get();case 9:snapshot=_context3.sent;_context3.next=12;return snapshot.data().cartItems;case 12:cartItems=_context3.sent;_context3.next=15;return put(fetchCartItemsFromFirestoreSuccess(cartItems));case 15:_context3.next=21;break;case 17:_context3.prev=17;_context3.t0=_context3[\"catch\"](0);_context3.next=21;return put(fetchCartItemsFromFirestoreFailure(_context3.t0));case 21:case\"end\":return _context3.stop();}}},_marked3,null,[[0,17]]);}export function onSignOutSuccess(){return _regeneratorRuntime.wrap(function onSignOutSuccess$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeLatest(UserActionTypes.SIGN_OUT_SUCCESS,clearCartOnSignOutSuccess);case 2:case\"end\":return _context4.stop();}}},_marked4);}export function onAddCartToFirestoreStart(){return _regeneratorRuntime.wrap(function onAddCartToFirestoreStart$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return takeLatest(CartActionTypes.ADD_CART_TO_FIRESTORE_START,addCartToFirestoreAsync);case 2:case\"end\":return _context5.stop();}}},_marked5);}export function onFetchCartItemsFromFirestoreStart(){return _regeneratorRuntime.wrap(function onFetchCartItemsFromFirestoreStart$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return takeLatest(CartActionTypes.FETCH_CART_ITEMS_FROM_FIRESTORE_START,fetchCartItemsFromFirestoreAsync);case 2:case\"end\":return _context6.stop();}}},_marked6);}export function cartSagas(){return _regeneratorRuntime.wrap(function cartSagas$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return all([call(onSignOutSuccess),call(onAddCartToFirestoreStart),call(onFetchCartItemsFromFirestoreStart)]);case 2:case\"end\":return _context7.stop();}}},_marked7);}","map":{"version":3,"sources":["/Users/michalwanto/Desktop/Testing-Trial/client/src/redux/cart/cart.sagas.js"],"names":["clearCartOnSignOutSuccess","addCartToFirestoreAsync","fetchCartItemsFromFirestoreAsync","onSignOutSuccess","onAddCartToFirestoreStart","onFetchCartItemsFromFirestoreStart","cartSagas","all","put","takeLatest","call","UserActionTypes","getCurrentUser","firestore","clearCart","fetchCartItemsFromFirestoreSuccess","fetchCartItemsFromFirestoreFailure","CartActionTypes","items","payload","userAuth","doc","uid","userRef","get","snapshot","map","item","mapCartItems","set","data","cartItems","console","log","SIGN_OUT_SUCCESS","ADD_CART_TO_FIRESTORE_START","FETCH_CART_ITEMS_FROM_FIRESTORE_START"],"mappings":"oXAaiBA,yB,iDAIAC,uB,iDAeAC,gC,iDAYAC,gB,iDAIAC,yB,iDAOAC,kC,iDAOAC,S,EA9DjB,OAASC,GAAT,CAAcC,GAAd,CAAmBC,UAAnB,CAA+BC,IAA/B,KAA2C,oBAA3C,CAEA,MAAOC,CAAAA,eAAP,KAA4B,oBAA5B,CAEA,OAASC,cAAT,CAAyBC,SAAzB,KAA0C,+BAA1C,CAEA,OACEC,SADF,CAEEC,kCAFF,CAGEC,kCAHF,KAIO,gBAJP,CAKA,MAAOC,CAAAA,eAAP,KAA4B,cAA5B,CAEA,MAAO,SAAUjB,CAAAA,yBAAV,qJACL,MAAMQ,CAAAA,GAAG,CAACM,SAAS,EAAV,CAAT,CADK,sDAIP,MAAO,SAAUb,CAAAA,uBAAV,2LAA6CiB,KAA7C,MAAoCC,OAApC,mCAEc,MAAMP,CAAAA,cAAc,EAApB,CAFd,OAEGQ,QAFH,iCAGa,MAAMP,CAAAA,SAAS,CAACQ,GAAV,iBAAuBD,QAAQ,CAACE,GAAhC,EAAN,CAHb,OAGGC,OAHH,kCAIc,MAAMA,CAAAA,OAAO,CAACC,GAAR,EAAN,CAJd,QAIGC,QAJH,kCAKkB,MAAMP,CAAAA,KAAK,CAACQ,GAAN,CAAU,SAACC,IAAD,QAAUA,CAAAA,IAAV,EAAV,CAAN,CALlB,QAKGC,YALH,kCAMH,MAAML,CAAAA,OAAO,CAACM,GAAR,gCACDJ,QAAQ,CAACK,IAAT,EADC,MAEJC,SAAS,CAAEH,YAFP,GAAN,CANG,6FAWHI,OAAO,CAACC,GAAR,eAXG,uEAeP,MAAO,SAAU/B,CAAAA,gCAAV,yNAEc,MAAMU,CAAAA,cAAc,EAApB,CAFd,OAEGQ,QAFH,iCAGa,MAAMP,CAAAA,SAAS,CAACQ,GAAV,iBAAuBD,QAAQ,CAACE,GAAhC,EAAN,CAHb,OAGGC,OAHH,iCAIc,MAAMA,CAAAA,OAAO,CAACC,GAAR,EAAN,CAJd,OAIGC,QAJH,kCAKe,MAAMA,CAAAA,QAAQ,CAACK,IAAT,GAAgBC,SAAtB,CALf,QAKGA,SALH,kCAMH,MAAMvB,CAAAA,GAAG,CAACO,kCAAkC,CAACgB,SAAD,CAAnC,CAAT,CANG,+GAQH,MAAMvB,CAAAA,GAAG,CAACQ,kCAAkC,cAAnC,CAAT,CARG,uEAYP,MAAO,SAAUb,CAAAA,gBAAV,gJACL,MAAMM,CAAAA,UAAU,CAACE,eAAe,CAACuB,gBAAjB,CAAmClC,yBAAnC,CAAhB,CADK,wDAIP,MAAO,SAAUI,CAAAA,yBAAV,yJACL,MAAMK,CAAAA,UAAU,CACdQ,eAAe,CAACkB,2BADF,CAEdlC,uBAFc,CAAhB,CADK,wDAOP,MAAO,SAAUI,CAAAA,kCAAV,kKACL,MAAMI,CAAAA,UAAU,CACdQ,eAAe,CAACmB,qCADF,CAEdlC,gCAFc,CAAhB,CADK,wDAOP,MAAO,SAAUI,CAAAA,SAAV,yIACL,MAAMC,CAAAA,GAAG,CAAC,CACRG,IAAI,CAACP,gBAAD,CADI,CAERO,IAAI,CAACN,yBAAD,CAFI,CAGRM,IAAI,CAACL,kCAAD,CAHI,CAAD,CAAT,CADK","sourcesContent":["import { all, put, takeLatest, call } from \"redux-saga/effects\";\n\nimport UserActionTypes from \"../user/user.types\";\n\nimport { getCurrentUser, firestore } from \"../../firebase/firebase.utils\";\n\nimport {\n  clearCart,\n  fetchCartItemsFromFirestoreSuccess,\n  fetchCartItemsFromFirestoreFailure,\n} from \"./cart.actions\";\nimport CartActionTypes from \"./cart.types\";\n\nexport function* clearCartOnSignOutSuccess() {\n  yield put(clearCart());\n}\n\nexport function* addCartToFirestoreAsync({ payload: items }) {\n  try {\n    const userAuth = yield getCurrentUser();\n    const userRef = yield firestore.doc(`users/${userAuth.uid}`);\n    const snapshot = yield userRef.get();\n    const mapCartItems = yield items.map((item) => item);\n    yield userRef.set({\n      ...snapshot.data(),\n      cartItems: mapCartItems,\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nexport function* fetchCartItemsFromFirestoreAsync() {\n  try {\n    const userAuth = yield getCurrentUser();\n    const userRef = yield firestore.doc(`users/${userAuth.uid}`);\n    const snapshot = yield userRef.get();\n    const cartItems = yield snapshot.data().cartItems;\n    yield put(fetchCartItemsFromFirestoreSuccess(cartItems));\n  } catch (error) {\n    yield put(fetchCartItemsFromFirestoreFailure(error));\n  }\n}\n\nexport function* onSignOutSuccess() {\n  yield takeLatest(UserActionTypes.SIGN_OUT_SUCCESS, clearCartOnSignOutSuccess);\n}\n\nexport function* onAddCartToFirestoreStart() {\n  yield takeLatest(\n    CartActionTypes.ADD_CART_TO_FIRESTORE_START,\n    addCartToFirestoreAsync\n  );\n}\n\nexport function* onFetchCartItemsFromFirestoreStart() {\n  yield takeLatest(\n    CartActionTypes.FETCH_CART_ITEMS_FROM_FIRESTORE_START,\n    fetchCartItemsFromFirestoreAsync\n  );\n}\n\nexport function* cartSagas() {\n  yield all([\n    call(onSignOutSuccess),\n    call(onAddCartToFirestoreStart),\n    call(onFetchCartItemsFromFirestoreStart),\n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}